{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bruce/Desktop/Projects/Megaai/frontend/src/lib/axios.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst api = axios.create({\r\n    baseURL: process.env.NEXT_PUBLIC_API_URL,\r\n    headers: {\r\n        'Content-Type': 'application/json',\r\n        'Accept': 'application/json',\r\n    },\r\n    withCredentials: false, // For Sanctum cookie-based auth if on same domain, but we are on different ports (3000 vs 8000).\r\n    // API Tokens usage:\r\n});\r\n\r\napi.interceptors.request.use((config) => {\r\n    const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\r\n    console.log(`[Axios Request] ${config.method?.toUpperCase()} ${config.url}`, {\r\n        hasToken: !!token,\r\n        headers: config.headers\r\n    });\r\n    if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n});\r\n\r\napi.interceptors.response.use(\r\n    (response) => {\r\n        console.log(`[Axios Response] ${response.status} ${response.config.url}`, response.data);\r\n        return response;\r\n    },\r\n    (error) => {\r\n        console.error(`[Axios Error] ${error.response?.status} ${error.config?.url}`, error.response?.data);\r\n\r\n        if (error.response?.status === 503 && error.response?.data?.maintenance) {\r\n            if (typeof window !== 'undefined' && window.location.pathname !== '/maintenance') {\r\n                window.location.href = '/maintenance';\r\n            }\r\n        }\r\n\r\n        if (error.response?.status === 401 || error.response?.status === 403) {\r\n            if (typeof window !== 'undefined') {\r\n                const is403 = error.response?.status === 403;\r\n                const msg = error.response?.data?.message || (is403 ? \"Access Forbidden\" : \"Unauthorized\");\r\n\r\n                // If 403, we might want to log user out if it's a persistent auth issue\r\n                if (error.response?.status === 401 || (is403 && !window.location.pathname.startsWith('/admin'))) {\r\n                    localStorage.removeItem('token');\r\n                    localStorage.removeItem('user');\r\n                    if (!window.location.pathname.startsWith('/auth')) {\r\n                        window.location.href = '/auth/login?error=' + encodeURIComponent(msg);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\nexport default api;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,MAAM,6LAAK,CAAC,MAAM,CAAC;IACrB,OAAO;IACP,SAAS;QACL,gBAAgB;QAChB,UAAU;IACd;IACA,iBAAiB;AAErB;AAEA,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAC1B,MAAM,QAAQ,sCAAgC,0BAAgC;IAC9E,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,OAAO,MAAM,EAAE,cAAc,CAAC,EAAE,OAAO,GAAG,EAAE,EAAE;QACzE,UAAU,CAAC,CAAC;QACZ,SAAS,OAAO,OAAO;IAC3B;IACA;;IAGA,OAAO;AACX;AAEA,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CACzB,CAAC;IACG,QAAQ,GAAG,CAAC,CAAC,iBAAiB,EAAE,SAAS,MAAM,CAAC,CAAC,EAAE,SAAS,MAAM,CAAC,GAAG,EAAE,EAAE,SAAS,IAAI;IACvF,OAAO;AACX,GACA,CAAC;IACG,QAAQ,KAAK,CAAC,CAAC,cAAc,EAAE,MAAM,QAAQ,EAAE,OAAO,CAAC,EAAE,MAAM,MAAM,EAAE,KAAK,EAAE,MAAM,QAAQ,EAAE;IAE9F,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,MAAM,QAAQ,EAAE,MAAM,aAAa;QACrE;;IAGJ;IAEA,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,MAAM,QAAQ,EAAE,WAAW,KAAK;QAClE;;IAaJ;IACA,OAAO,QAAQ,MAAM,CAAC;AAC1B;uCAGW"}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bruce/Desktop/Projects/Megaai/frontend/src/app/dashboard/wallet/callback/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport api from \"@/lib/axios\";\r\nimport { toast } from \"sonner\";\r\nimport { Loader2, CheckCircle2, XCircle } from \"lucide-react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { useCart } from \"@/context/CartContext\";\r\n\r\nexport default function PaymentCallbackPage() {\r\n    const searchParams = useSearchParams();\r\n    const router = useRouter();\r\n    const { clearCart } = useCart();\r\n    const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\r\n    const [message, setMessage] = useState(\"Verifying payment...\");\r\n\r\n    const reference = searchParams.get('reference') || searchParams.get('trxref');\r\n\r\n    useEffect(() => {\r\n        if (!reference) {\r\n            setStatus('error');\r\n            setMessage(\"No payment reference found.\");\r\n            return;\r\n        }\r\n\r\n        const verifyPayment = async () => {\r\n            try {\r\n                // Pass all query parameters to the backend verification endpoint\r\n                const res = await api.get(`/paystack/verify?${searchParams.toString()}`);\r\n                if (res.data.message) {\r\n                    setStatus('success');\r\n                    setMessage(res.data.message);\r\n                    toast.success(res.data.message);\r\n\r\n                    // Clear cart for bundle purchases\r\n                    clearCart();\r\n\r\n                    setTimeout(() => {\r\n                        router.push(res.data.redirect_url || '/dashboard/wallet');\r\n                    }, 3000);\r\n                }\r\n            } catch (err: any) {\r\n                setStatus('error');\r\n                const errorMsg = err.response?.data?.message || \"Verification failed.\";\r\n                setMessage(errorMsg);\r\n                toast.error(errorMsg);\r\n            }\r\n        };\r\n\r\n        verifyPayment();\r\n    }, [reference, router]);\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center min-h-[70vh] p-4 text-center\">\r\n            <motion.div\r\n                initial={{ scale: 0.8, opacity: 0 }}\r\n                animate={{ scale: 1, opacity: 1 }}\r\n                className=\"max-w-md w-full bg-white dark:bg-slate-900 p-10 rounded-[2.5rem] shadow-2xl border border-slate-100 dark:border-slate-800\"\r\n            >\r\n                {status === 'loading' && (\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"relative w-20 h-20 mx-auto\">\r\n                            <Loader2 className=\"w-20 h-20 text-primary animate-spin\" />\r\n                            <div className=\"absolute inset-0 bg-primary/10 rounded-full blur-xl animate-pulse\" />\r\n                        </div>\r\n                        <h2 className=\"text-2xl font-black tracking-tight\">Verifying Payment</h2>\r\n                        <p className=\"text-muted-foreground font-medium italic\">Please don't close this page while we confirm your transaction...</p>\r\n                    </div>\r\n                )}\r\n\r\n                {status === 'success' && (\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"w-20 h-20 bg-emerald-100 dark:bg-emerald-900/30 rounded-full flex items-center justify-center mx-auto shadow-lg shadow-emerald-500/20\">\r\n                            <CheckCircle2 className=\"w-12 h-12 text-emerald-600 dark:text-emerald-400\" />\r\n                        </div>\r\n                        <h2 className=\"text-2xl font-black tracking-tight text-slate-800 dark:text-slate-100\">Payment Successful!</h2>\r\n                        <p className=\"text-muted-foreground font-medium\">{message}</p>\r\n                        <p className=\"text-xs font-bold text-primary uppercase tracking-[0.2em] animate-pulse\">Redirecting you back...</p>\r\n                    </div>\r\n                )}\r\n\r\n                {status === 'error' && (\r\n                    <div className=\"space-y-6\">\r\n                        <div className=\"w-20 h-20 bg-rose-100 dark:bg-rose-900/30 rounded-full flex items-center justify-center mx-auto shadow-lg shadow-rose-500/20\">\r\n                            <XCircle className=\"w-12 h-12 text-rose-600 dark:text-rose-400\" />\r\n                        </div>\r\n                        <h2 className=\"text-2xl font-black tracking-tight text-slate-800 dark:text-slate-100\">Verification Error</h2>\r\n                        <p className=\"text-muted-foreground font-medium\">{message}</p>\r\n                        <button\r\n                            onClick={() => router.push('/dashboard/wallet')}\r\n                            className=\"w-full h-14 bg-slate-900 dark:bg-primary text-white rounded-2xl font-black text-sm uppercase tracking-widest hover:scale-105 transition-transform\"\r\n                        >\r\n                            Return to Wallet\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AARA;;;;;;;;;AAUe,SAAS;IACpB,MAAM,eAAe,IAAA,kMAAe;IACpC,MAAM,SAAS,IAAA,4LAAS;IACxB,MAAM,EAAE,SAAS,EAAE,GAAG,IAAA,sLAAO;IAC7B,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,8PAAQ,EAAkC;IACtE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,8PAAQ,EAAC;IAEvC,MAAM,YAAY,aAAa,GAAG,CAAC,gBAAgB,aAAa,GAAG,CAAC;IAEpE,IAAA,+PAAS,EAAC;QACN,IAAI,CAAC,WAAW;YACZ,UAAU;YACV,WAAW;YACX;QACJ;QAEA,MAAM,gBAAgB;YAClB,IAAI;gBACA,iEAAiE;gBACjE,MAAM,MAAM,MAAM,2KAAG,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAE,aAAa,QAAQ,IAAI;gBACvE,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;oBAClB,UAAU;oBACV,WAAW,IAAI,IAAI,CAAC,OAAO;oBAC3B,8LAAK,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC,OAAO;oBAE9B,kCAAkC;oBAClC;oBAEA,WAAW;wBACP,OAAO,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,IAAI;oBACzC,GAAG;gBACP;YACJ,EAAE,OAAO,KAAU;gBACf,UAAU;gBACV,MAAM,WAAW,IAAI,QAAQ,EAAE,MAAM,WAAW;gBAChD,WAAW;gBACX,8LAAK,CAAC,KAAK,CAAC;YAChB;QACJ;QAEA;IACJ,GAAG;QAAC;QAAW;KAAO;IAEtB,qBACI,2RAAC;QAAI,WAAU;kBACX,cAAA,2RAAC,iPAAM,CAAC,GAAG;YACP,SAAS;gBAAE,OAAO;gBAAK,SAAS;YAAE;YAClC,SAAS;gBAAE,OAAO;gBAAG,SAAS;YAAE;YAChC,WAAU;;gBAET,WAAW,2BACR,2RAAC;oBAAI,WAAU;;sCACX,2RAAC;4BAAI,WAAU;;8CACX,2RAAC,yQAAO;oCAAC,WAAU;;;;;;8CACnB,2RAAC;oCAAI,WAAU;;;;;;;;;;;;sCAEnB,2RAAC;4BAAG,WAAU;sCAAqC;;;;;;sCACnD,2RAAC;4BAAE,WAAU;sCAA2C;;;;;;;;;;;;gBAI/D,WAAW,2BACR,2RAAC;oBAAI,WAAU;;sCACX,2RAAC;4BAAI,WAAU;sCACX,cAAA,2RAAC,kRAAY;gCAAC,WAAU;;;;;;;;;;;sCAE5B,2RAAC;4BAAG,WAAU;sCAAwE;;;;;;sCACtF,2RAAC;4BAAE,WAAU;sCAAqC;;;;;;sCAClD,2RAAC;4BAAE,WAAU;sCAA0E;;;;;;;;;;;;gBAI9F,WAAW,yBACR,2RAAC;oBAAI,WAAU;;sCACX,2RAAC;4BAAI,WAAU;sCACX,cAAA,2RAAC,oQAAO;gCAAC,WAAU;;;;;;;;;;;sCAEvB,2RAAC;4BAAG,WAAU;sCAAwE;;;;;;sCACtF,2RAAC;4BAAE,WAAU;sCAAqC;;;;;;sCAClD,2RAAC;4BACG,SAAS,IAAM,OAAO,IAAI,CAAC;4BAC3B,WAAU;sCACb;;;;;;;;;;;;;;;;;;;;;;;AAQzB"}}]
}